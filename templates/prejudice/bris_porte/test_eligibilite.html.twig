{% extends 'base.html.twig' %}

{% block title %}Bris de porte : tester mon éligibilité{% endblock %}

{% block stylesheets %}
    <script src="{{ asset('build/alpinejs/cdn.js') }}" defer></script>
    <style>
        .udraw-terms-conditions {
            height: 25rem;
            width: 100%;
            background-image: url('{{ asset("/images/undraw_terms-conditions.svg") }}');
            background-repeat: no-repeat;
            background-size: 70%;
            background-position: center;
        }

        .pr-eligibilite_form-group {
            background-color: var(--background-alt-grey);
        }

        .pr-body_header {
            margin-top: -1rem;
            padding-top: 2rem;
            background-color: var(--background-alt-grey);
        }

        .fr-button-icon-spin:before {
            animation-name: spin;
              animation-duration: 1500ms;
              animation-iteration-count: infinite;
              animation-timing-function: linear;
        }

        input[type=radio] {
            z-index: 2;
        }

        @keyframes spin {
            from {
                transform:rotate(0deg);
            }
            to {
                transform:rotate(360deg);
            }
        }

        /* AlpineJS */
        [x-cloak] {
            display: none !important;
        }
    </style>
{% endblock stylesheets %}

{% block modale %}
<dialog aria-labelledby="modale-test-eligibilite-title" id="modale-test-eligibilite" class="fr-modal fr-modal--opened" role="dialog"
        data-fr-opened="true">
    <div class="fr-container fr-container--fluid fr-container-md">
        <div class="fr-grid-row fr-grid-row--center">
            <div class="fr-col-12 fr-col-md-8 fr-col-lg-6">
                <div class="fr-modal__body">
                    <form
                        name="eligibilite-test-form"
                        action="{{ url(app.current_route) }}"
                        method="POST"
                        {# x-data="eligibiliteTestForm()"#}
                        x-data="{ statut: null, estConcerne: null, estRecherche: null, recoursAssurance: null, termine: false }"
                    >
                        <div class="fr-modal__header">
                            <button
                                class="fr-btn--close fr-btn"
                                aria-controls="modale-test-eligibilite"
                                type="button"
                            >Fermer
                            </button>
                        </div>
                        <div class="fr-modal__content">
                            <h1 id="fr-modal-title-foo-modal" class="fr-modal__title">Tester mon éligibilité à l'indemnisation</h1>

                            <p x-show="!termine">
                                La porte de votre logement a été fracturé par les forces de police dans le cadre d'une opération judiciaire.
                            </p>

                            <div class="fr-col-12" x-show="!termine">
                                <label>
                                    Quel est votre statut par rapport au logement ?
                                </label>
                                <ul class="fr-btns-group fr-btns-group--inline fr-btns-group--sm fr-btns-group--right fr-pt-2w">
                                    <li>
                                        <button
                                            class="fr-btn fr-btn--secondary"
                                            :class="{ 'fr-btn--secondary': ('PROPRIETAIRE_OCCUPANT' !== statut) }"
                                            type="button"
                                            @click="statut = ('PROPRIETAIRE_OCCUPANT' === statut) ? null : 'PROPRIETAIRE_OCCUPANT'"
                                        >
                                            Propriétaire occupant
                                        </button>
                                    </li>
                                    <li>
                                        <button
                                            class="fr-btn fr-btn--secondary"
                                            :class="{ 'fr-btn--secondary': ('PROPRIETAIRE_BAILLEUR' !== statut) }"
                                            type="button"
                                            @click="statut = ('PROPRIETAIRE_BAILLEUR' === statut) ? null : 'PROPRIETAIRE_BAILLEUR'"
                                        >
                                            Propriétaire bailleur
                                        </button>
                                    </li>
                                    <li>
                                        <button
                                            class="fr-btn fr-btn--secondary"
                                            :class="{ 'fr-btn--secondary': ('LOCATAIRE' !== statut) }"
                                            type="button"
                                            @click="statut = ('LOCATAIRE' === statut) ? null : 'LOCATAIRE'"
                                        >
                                            Locataire
                                        </button>
                                    </li>
                                </ul>
                            </div>

                            <div class="fr-col-12" x-show="!termine && !!statut" x-cloak>
                                <label>
                                    Êtes-vous concerné par l'opération de police judiciaire ?
                                </label>
                                <ul class="fr-btns-group fr-btns-group--inline fr-btns-group--sm fr-btns-group--right fr-pt-2w">
                                    <li>
                                        <button
                                            class="fr-btn fr-btn--secondary"
                                            :class="{ 'fr-btn--secondary': ('OUI' !== estConcerne) }"
                                            type="button"
                                            @click="estConcerne = ('OUI' === estConcerne) ? null : 'OUI'"
                                        >
                                            Oui
                                        </button>
                                    </li>
                                    <li>
                                        <button
                                            class="fr-btn fr-btn--secondary"
                                            :class="{ 'fr-btn--secondary': ('NON' !== estConcerne) }"
                                            type="button"
                                            @click="estConcerne = ('NON' === estConcerne) ? null : 'NON'"
                                        >
                                            Non
                                        </button>
                                    </li>
                                </ul>
                            </div>

                            <div class="fr-col-12" x-show="!termine && !!estConcerne" x-cloak>
                                <input type="hidden" name="estConcerne" :value="'OUI' === estRecherche" />
                                <label>
                                    Est-ce que la personne recherchée réside ou est hébergée à cette adresse ?
                                </label>
                                <div class="fr-alert fr-alert--info" x-if="statut === 'PROPRIETAIRE_BAILLEUR'">
                                    <p class="fr-text--xs">
                                        Si votre locataire est la personne visée par l'opération de police judiciaire,
                                        vous pouvez engager sa <b>responsabilité contractuelle</b> (article 1732 du code
                                        civil).
                                    </p>
                                </div>
                                <ul class="fr-btns-group fr-btns-group--inline fr-btns-group--sm fr-btns-group--right fr-pt-2w">
                                    <li>
                                        <button
                                            class="fr-btn fr-btn--secondary"
                                            :class="{ 'fr-btn--secondary': ('OUI' !== estRecherche) }"
                                            type="button"
                                            @click="estRecherche = ('OUI' === estRecherche) ? null : 'OUI'"
                                        >
                                            Oui
                                        </button>
                                    </li>
                                    <li>
                                        <button
                                            class="fr-btn fr-btn--secondary"
                                            :class="{ 'fr-btn--secondary': ('NON' !== estRecherche) }"
                                            type="button"
                                            @click="estRecherche = ('NON' === estRecherche) ? null : 'NON'"
                                        >
                                            Non
                                        </button>
                                    </li>
                                </ul>
                            </div>

                            <div class="fr-col-12" x-show="!termine && !!estRecherche" x-cloak>
                                <label>
                                    Avez-vous sollicité votre <b>assurance habitation</b> afin de vérifier la prise en charge du sinistre ?
                                </label>
                                <div class="fr-alert fr-alert--info">
                                    <p class="fr-text--xs">
                                        Afin de déposer un dossier de demande d'indemnisation, <b>une attestation de non
                                        prise en charge</b> du sinistre par votre assureur vous sera demandée.
                                    </p>
                                </div>


                                <ul class="fr-btns-group fr-btns-group--inline fr-btns-group--sm fr-btns-group--right fr-pt-2w">
                                    <li>
                                        <button
                                            class="fr-btn fr-btn--secondary"
                                            :class="{ 'fr-btn--secondary': ('OUI' !== recoursAssurance) }"
                                            type="button"
                                            @click="recoursAssurance = 'OUI'; termine = true;"
                                        >
                                            Oui
                                        </button>
                                    </li>
                                    <li>
                                        <button
                                            class="fr-btn fr-btn--secondary"
                                            :class="{ 'fr-btn--secondary': ('NON' !== recoursAssurance) }"
                                            type="button"
                                            @click="recoursAssurance = 'NON'; termine = true;"
                                        >
                                            Non
                                        </button>
                                    </li>
                                </ul>

                            </div>

                            <div
                                class="fr-alert fr-alert--warning"
                                x-show="termine && estConcerne === 'OUI'"
                                x-cloak
                            >
                                <h3 class="fr-alert__title">Vous n'êtes pas éligible à l'indemnisation</h3>
                                <p>
                                    [CONCERNÉ WARNING]<br/>
                                    <br/>
                                    En étant concerné par l'opération de police judiciaire, vous ne pouvez prétendre à
                                    une quelconque indemnisation.<br/>
                                    <br/>
                                    Vous pouvez malgré tout déposer votre demande en créant votre compte via le bouton
                                    ci-dessous. Mais soyez conscient que celle-ci n'a que très peu de chance d'aboutir
                                    à une indemnisation.
                                </p>
                            </div>

                            <div
                                class="fr-alert fr-alert--success"
                                x-show="termine && statut === 'PROPRIETAIRE_OCCUPANT' && estConcerne === 'NON' && estRecherche === 'NON'"
                                x-cloak
                            >
                                <h3 class="fr-alert__title">Vous êtes éligible à l'indemnisation</h3>
                                <p>
                                    [PROPRIETAIRE OCCUPANT OK]<br/>
                                    <br/>
                                    Vous pouvez dès à présent effectuer votre demande amiable d'indemnisation en créant
                                    votre compte via le bouton ci-dessous.
                                </p>
                            </div>

                            <div
                                class="fr-alert fr-alert--success"
                                x-show="termine && statut === 'PROPRIETAIRE_BAILLEUR' && estConcerne === 'NON' && estRecherche === 'NON'"
                                x-cloak
                            >
                                <h3 class="fr-alert__title">Vous êtes éligible à l'indemnisation</h3>
                                <p>
                                    [PROPRIETAIRE BAILLEUR OK]<br/>
                                    <br/>
                                    Vous pouvez dès à présent effectuer votre demande amiable d'indemnisation en créant
                                    votre compte via le bouton ci-dessous.
                                </p>
                            </div>

                            <div
                                    x-show="termine && statut === 'LOCATAIRE' && estConcerne === 'NON' && estRecherche === 'NON'"
                                    class="fr-alert fr-alert--success"
                                x-cloak
                            >
                                <h3 class="fr-alert__title">Vous êtes éligible à l'indemnisation</h3>
                                <p>
                                    [LOCATAIRE OCCUPANT OK]<br/>
                                    <br/>
                                    Vous pouvez dès à présent effectuer votre demande amiable d'indemnisation en créant
                                    votre compte via le bouton ci-dessous.
                                </p>
                            </div>
                        </div>

                        <div class="fr-modal__footer">
                            <div class="fr-btns-group fr-btns-group--right fr-btns-group--inline-lg">
                                <button
                                    x-show="termine"
                                    x-cloak
                                    class="fr-btn fr-btn--tertiary-no-outline"
                                    aria-controls="modale-test-eligibilite"
                                    data-fr-js-modal-button="true"
                                    type="button"
                                >Annuler
                                </button>
                                <button
                                    class="fr-btn"
                                    type="submit"
                                    x-show="termine"
                                    x-cloak
                                >Faire ma demande
                                </button>

                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</dialog>
{% endblock modale %}

{% block main %}
    <div id="page-content">
        <div class="pr-body_header">
            <section class="pr-eligibilite_header">
                <div class="fr-container">
                    <div class="fr-pb-4w">
                        <h1>Bris de porte</h1>
                        <p>Je souhaite effectuer une demande d’indemnisation pour un bris de portes ou autres dégâts
                            matériels causés dans le cadre d'une opération de police judiciaire (perquisition
                            judiciaire,
                            interpellation d'un individu, ...)</p>
                    </div>
                </div>
            </section>
        </div>
        <div class="fr-container">
            <div class="fr-grid-row">
                <div class="fr-col-8">
                    <section class="pr-eligibilite_conditions">
                        <div class="fr-pt-8w">
                            <h2>Quelles sont les conditions à remplir pour être indemnisé(e) ?</h2>
                            <ul>
                                <li>Vous ne devez pas être concerné(e) par l'opération de police judiciaire</li>
                            </ul>
                            <b>ET</b>
                            <ul>
                                <li>L'opération de police judiciaire doit avoir été réalisée par erreur à votre domicile
                                </li>
                            </ul>
                        </div>
                    </section>
                    <section class="pr-eligibilite_action">
                        <div class="fr-pb-8w fr-pt-2w">
                            <button class="fr-btn" data-fr-opened="false" aria-controls="modale-test-eligibilite">Tester
                                mon éligibilité à l'indemnisation
                            </button>
                        </div>
                    </section>
                </div>
                <div class="fr-col-4">
                    <div class="fr-py-2w">
                        <div class="udraw-terms-conditions"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script type="text/javascript">
        function eligibiliteTestForm() {
            return {
                questions: [

                ]
            };
        };
    </script>
{% endblock javascripts %}
